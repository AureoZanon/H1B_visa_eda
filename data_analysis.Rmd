---
title: "H1-B Visa Petitions for Data Science Positions in 2015"
author: "Sharan Naribole"
output:
  html_document:
    fig_caption: yes
    fig_height: 8
    fig_width: 10
    theme: united
    toc: yes
    toc_depth: 2
  html_notebook:
    theme: united
    toc: yes
    toc_depth: 2
  pdf_document: default
---

# Author: Sharan Naribole
# Filename: data_processing.Rmd
# H-1B Visa Petitions exploratory data analysis on applications disclosure data in the period 2011-2016

Contributed by Sharan Naribole. He is currently undertaking the part-time online bootcamp organized by NYC Data Science Academy (Dec 2016- April 2017). This blog is based on his bootcamp project - R Exploratory Data Analysis

In this notebook, I will utilize the transformed data set in the notebook data_processing.Rmd to answer interesting questions on the H-1B visa dataset. The key questions I will be covering include:

Section I. High-Applicant Employers:

1) Which Employers send most number of H-1B visa applications? 

2) What is the Percentage share out of the 85,000 visa cap for the Employers with most applications?

3) Most common Job Titles and their Relative wages to Industry standard as well as absolute?

Section II. Data Science related job position Analysis:

1) Comparison of Number of applications and Wages for Data Scientist, Data Engineer and Machine Learning

2) Job Level comparison for Starting positions, Senior/ Lead and Manager positions


Section III. Location-based analysis for Data Scientist related jobs:

1) How does the Wage for Data Science related positions vary by state? By worksite?

2) Are the jobs concentrated in few specific regions?

3) Correlation between Wage and Cost of Living index?

Let's begin the analysis by loading the libraries and the dataframe!

```{r}
library(dplyr)
library(ggplot2)
library(ggthemes)
library(RColorBrewer)
library(fiftystater)
library(ggrepel)
library(ggmap)
source("helpers.R")
```
helpers.R includes a suite of plotting and filter functions that will help us with the data analysis. 


```{r}
h1b_df <- readRDS("h1b_compact.rds")

colnames(h1b_df)
```

<h2> High-Applicant Employers </h2>

In this sub-section, I analyze employers with high number of applications. Let's begin by finding out the top 10 employers with the most number of applications in the period 2011-2016.

```{r}
input <- plot_input(h1b_df, "EMPLOYER_NAME", "YEAR", "TotalApps",filter = TRUE, Ntop = 10)

plot_output(input, 'EMPLOYER_NAME','YEAR','TotalApps', 'EMPLOYER','TOTAL NO. of APPLICATIONS')
```

We observe here that the Employer Names takes most of the space leaving almost little for the actual plot. For this purpose, I cut short Employer names to only the first word in their title.

```{r}
h1b_df$EMPLOYER_COMPACT = sapply(h1b_df$EMPLOYER_NAME,substr,start = 1, stop = 10)
```
```{r}
input <- plot_input(h1b_df, "EMPLOYER_COMPACT", "YEAR", "TotalApps",filter = TRUE, Ntop = 10)

plot_output(input, 'EMPLOYER_COMPACT','YEAR','TotalApps', 'EMPLOYER','TOTAL NO. of APPLICATIONS')
```

Observations:

1. Infosys leads the pack by a huge margin with over 30000 applications in 2013 and 2015.

2. The Top 10 list is dominated by the Indian IT companies.

3. We observe a slight dip in the number of applications from Infosys, Wipro, Tata Consultancy, IBM India and HCL America. This is because of increased incorporation of automation in the IT industry. According to this article https://qz.com/901292/indian-it-firms-like-wipro-tcs-and-infosys-have-been-preparing-for-changes-in-h1b-visa-laws-and-donald-trumps-america-for-several-years/, the Indian IT firms have been preparing for nearly a decade through increased focus on automation, cloud computing and artificial intelligence.

4. As we have shortened the Employer Name to the first 10 letters, we observe that University is part of the list now. This is because University apply for H-1B for Post-Doctoral researchers and staff members. The visa provided to Post-Doctoral scholars are generally exempy from the H-1B Visa Cap.

Next, let's look at the Percentage Share of the Approved/Certified H-1B applications for these top 10 employers out of the 85000 cap.

```{r}
plot_output(input, 'EMPLOYER_COMPACT','YEAR','Share', 'EMPLOYER','% SHARE')
```

The assumption in this plot is that each certified H-1B application corresponds to a unique H-1B visa. Accordingly, if an employer's 8500 H-1B visa applications were certified then it's percetage share in the 85,000 visa cap is 10%. Based on this assumption, I make the following observations:

1. Over 90% of the certified H-1B visa applications belong to the IT companies with the most applications.

2. Infosys again takes a major share.

3. It doesn't make sense to have University in this plot as majority of the H-1B visa applications from Universities might be for Post-doctoral researcher positions which are H-1B visa cap exempt.


